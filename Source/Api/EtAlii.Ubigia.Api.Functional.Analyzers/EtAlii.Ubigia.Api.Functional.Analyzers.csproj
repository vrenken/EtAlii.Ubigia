<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>$(UbigiaLibraryTargetFramework)</TargetFramework>
    <ProjectGuid>991dfe15-55a3-4435-81fa-f56e996cd546</ProjectGuid>
    <PackageReleaseNotes>Migrated to .NET 5.0</PackageReleaseNotes>
    <RootNamespace>EtAlii.Ubigia.Api.Functional</RootNamespace>
    <PackProject>true</PackProject>
    <PackageId>$(AssemblyName)</PackageId>
    <GeneratePackageOnBuild>true</GeneratePackageOnBuild>
    <IncludeBuildOutput>false</IncludeBuildOutput>
    <SuppressDependenciesWhenPacking>true</SuppressDependenciesWhenPacking>
    <WarningsAsErrors>$(WarningsAsErrors);RS0016;RS0017;RS0022;RS0024;RS0025;RS0026;RS0027</WarningsAsErrors>
  </PropertyGroup>
  <ItemGroup>
    <ProjectReference Include="..\..\Frameworks\EtAlii.xTechnology.Diagnostics\EtAlii.xTechnology.Diagnostics\EtAlii.xTechnology.Diagnostics.csproj" />
    <ProjectReference Include="..\EtAlii.Ubigia.Api.Functional.Antlr\EtAlii.Ubigia.Api.Functional.Antlr.csproj" PrivateAssets="all" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.CodeAnalysis.CSharp" Version="3.9.0" PrivateAssets="all" />
    <PackageReference Update="NETStandard.Library" PrivateAssets="all" />
  </ItemGroup>

<!--  <ItemGroup>-->
<!--        <PackageReference Include="StrongNamer" Version="0.2.5" />-->
<!--  </ItemGroup>-->
<!--  <PropertyGroup>-->
<!--    <SignAssembly>true</SignAssembly>-->
<!--    <AssemblyOriginatorKeyFile>Certificate.snk</AssemblyOriginatorKeyFile>-->
<!--  </PropertyGroup>-->

  <PropertyGroup>
    <GetTargetPathDependsOn>$(GetTargetPathDependsOn);GetPackageDependencyTargetPaths;GetUbigiaDependencyTargetPaths</GetTargetPathDependsOn>
  </PropertyGroup>

  <ItemGroup>
    <!-- Package the generator in the analyzer directory of the nuget package -->
    <Content Include="Context\4. CodeGeneration\Build\CodeGeneration.ContentType.xaml" />
    <Content Include="Context\4. CodeGeneration\Build\CodeGeneration.Rules.xaml" />
    <Content Include="Context\4. CodeGeneration\Build\EtAlii.Ubigia.Api.Functional.Analyzers.props" />
    <Content Include="Context\4. CodeGeneration\Build\EtAlii.Ubigia.Api.Functional.Analyzers.targets" />
    <None Include="$(OutputPath)\$(AssemblyName).dll" Visible="false">
      <Pack>true</Pack>
      <PackagePath>analyzers/dotnet/cs/</PackagePath>
    </None>

    <Content Include="4. CodeGeneration\Build\*">
      <PackagePath>build\</PackagePath>
    </Content>

    <AdditionalFiles Include="AnalyzerReleases.Shipped.md" />
    <AdditionalFiles Include="AnalyzerReleases.Unshipped.md" />
  </ItemGroup>

  <ItemGroup>
    <!-- Generator dependencies -->
    <PackageReference Include="Antlr4.Runtime.Standard" Version="4.9.2" PrivateAssets="all">
      <GeneratePathProperty>true</GeneratePathProperty>
    </PackageReference>
    <PackageReference Include="Serilog" Version="2.10.0" PrivateAssets="all">
      <GeneratePathProperty>true</GeneratePathProperty>
    </PackageReference>
    <PackageReference Include="Serilog.Sinks.Seq" Version="5.0.1" PrivateAssets="all">
      <GeneratePathProperty>true</GeneratePathProperty>
    </PackageReference>
    <PackageReference Include="Serilog.Formatting.Compact" Version="1.1.0" PrivateAssets="all">
      <GeneratePathProperty>true</GeneratePathProperty>
    </PackageReference>
    <PackageReference Include="Serilog.Sinks.PeriodicBatching" Version="2.3.0" PrivateAssets="all">
      <GeneratePathProperty>true</GeneratePathProperty>
    </PackageReference>
    <PackageReference Include="Serilog.Sinks.File" Version="4.1.0" PrivateAssets="all">
      <GeneratePathProperty>true</GeneratePathProperty>
    </PackageReference>
  </ItemGroup>

  <ItemGroup>
    <Compile Remove="4. CodeGeneration\SchemaPocoGenerator.Diagnostics.cs" />
  </ItemGroup>

  <ItemGroup>
    <Folder Include="Context" />
  </ItemGroup>

  <Target Name="GetUbigiaDependencyTargetPaths">
    <ItemGroup>
      <TargetPathWithTargetPlatformMoniker Include="..\EtAlii.Ubigia.Api.Functional\$(OutDir)\EtAlii.Ubigia.Api.Functional.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="..\EtAlii.Ubigia\$(OutDir)\EtAlii.Ubigia.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="..\EtAlii.Ubigia.Api.Functional\$(OutDir)\EtAlii.Ubigia.Api.Functional.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="..\EtAlii.Ubigia.Api.Functional.Antlr\$(OutDir)\EtAlii.Ubigia.Api.Functional.Antlr.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="..\..\Frameworks\EtAlii.xTechnology.MicroContainer\EtAlii.xTechnology.MicroContainer\$(OutDir)\EtAlii.xTechnology.MicroContainer.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="..\..\Frameworks\EtAlii.xTechnology.Threading\EtAlii.xTechnology.Threading\$(OutDir)\EtAlii.xTechnology.Threading.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="..\..\Frameworks\EtAlii.xTechnology.Diagnostics\EtAlii.xTechnology.Diagnostics\$(OutDir)\EtAlii.xTechnology.Diagnostics.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="..\EtAlii.Ubigia.Api.Functional.Antlr\$(OutDir)\EtAlii.Ubigia.Api.Functional.Antlr.dll" IncludeRuntimeDependency="false" />
    </ItemGroup>
  </Target>

  <Target Name="GetPackageDependencyTargetPaths">
    <ItemGroup>
      <TargetPathWithTargetPlatformMoniker Include="$(PkgAntlr4_Runtime_Standard)\lib\$(UbigiaLibraryTargetFramework)\*.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="$(PkgSerilog)\lib\netstandard2.0\Serilog.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="$(PkgSerilog_Sinks_Seq)\lib\netstandard2.0\Serilog.Sinks.Seq.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="$(PkgSerilog_Sinks_File)\lib\netstandard1.3\Serilog.Sinks.File.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="$(PkgSerilog_Sinks_PeriodicBatching)\lib\netstandard2.0\Serilog.Sinks.PeriodicBatching.dll" IncludeRuntimeDependency="false" />
      <TargetPathWithTargetPlatformMoniker Include="$(PkgSerilog_Formatting_Compact)\lib\netstandard1.1\Serilog.Formatting.Compact.dll" IncludeRuntimeDependency="false" />
    </ItemGroup>
  </Target>
</Project>
